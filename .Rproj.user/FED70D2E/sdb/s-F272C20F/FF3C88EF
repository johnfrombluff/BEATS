{
    "collab_server" : "",
    "contents" : "#detach(package:rms)\nrequire( car )\n#dat$ATS_f      <- factor(dat$ATS_wMulti_2c, labels=c(\"Don't walk\", \"Walk\") )\ndat$ATS <- dat$ATS_Corrected_Clean\ndat$ATS_f      <- dat$ATvsMT; levels(dat$ATS_f) <-c(\"Don't walk\", \"Walk\")\ndat$whodecides <- recode(  dat$tsdecision, \"'My parents'='Other(s)'; 'School'='Other(s)'\")\n#dat$BMI_f      <- ordered( recode(dat$BMI_4cat, \"1=0;2=1;3=2\"), labels=c(\"Normal\", \"Overweightl\", \"Obese\") )\ndat$BMI_f      <- ordered( recode(dat$BMI_4cat, \" 'Underweight'='Normal Weight' \") )\ndat$cars3 <- ordered(recode( dat$HMcars,\"'Two'='Two or more'; 'Three'='Two or more'; 'Four or more'='Two or more'\" ) )\ndat$BMI_f <- factor(dat$BMI_2cat, labels=c(\"Healthy\", \"Unhealthy\") )\ndetach(package:car)\n\nrequire( rms )\n\nlabel(dat$cars3) <- \"Number of cars at home\"\nlevels(dat$NZDepCat3) <- c(\"High\", \"Med\", \"Low\")\n\n# Transform rating scale variables to numeric\n# Attitudes\ndat$interesting   <- as.numeric(dat$WSAint);     label(dat$interesting) <- \"Walking to school is interesting\"\ndat$pleasant      <- as.numeric(dat$WSAnice);    label(dat$pleasant)    <- \"Walking to school is pleasant\"\ndat$boring        <- as.numeric(dat$WSAstim);    label(dat$boring)      <- \"Walking to school is boring\"\ndat$healthy       <- as.numeric(dat$WSAhealthy); label(dat$healthy)     <- \"Walking to school is healthy\"\ndat$useful        <- as.numeric(dat$WSAuseful);  label(dat$useful)      <- \"Walking to school is useful\"\ndat$safe          <- as.numeric(dat$WSAsafe);    label(dat$safe)        <- \"Walking to school is safe\"\n\n# Motivations\ndat$exercise      <- as.numeric(dat$WSexercise); label(dat$exercise)    <- \"Walking is a way to get exercise\"\ndat$chat          <- as.numeric(dat$WSchat);     label(dat$chat    )    <- \"I can chat to friends walking\"\n\n# Barriers\ndat$onway         <- as.numeric(dat$WCSone);     label(dat$onway   )    <- \"School is on the way to somewhere\"\ndat$time          <- as.numeric(dat$WStime);     label(dat$time    )    <- \"Walking takes too much time\"\ndat$stuff         <- as.numeric(dat$WSbstuff);   label(dat$stuff   )    <- \"I have too much stuff\"\ndat$sched         <- as.numeric(dat$WSbsched);   label(dat$sched   )    <- \"After-school schedule\"\ndat$planning      <- as.numeric(dat$WSbplan);    label(dat$planning)    <- \"Takes too much planning\"\ndat$sweaty        <- as.numeric(dat$WSbsweat);   label(dat$sweaty  )    <- \"Makes me sweat\"\ndat$unsafe        <- as.numeric(dat$WSbsafe);    label(dat$unsafe  )    <- \"Not safe\"\ndat$tired         <- as.numeric(dat$WStired);    label(dat$tired   )    <- \"Often too tired\"\ndat$desire        <- as.numeric(dat$WSbwant);    label(dat$desire  )    <- \"I want to walk to school\"\n\n# Control\ndat$confd         <- as.numeric(dat$WSconf);     label(dat$confd      )  <- \"I am confident I can walk\"\ndat$control       <- as.numeric(dat$WScontrol);  label(dat$control    )  <- \"I am in control of travel mode\"\ndat$intention     <- as.numeric(dat$WSintend);   label(dat$intention)    <- \"I intend to walk to school\"\n\n# Family\ndat$adults        <- as.numeric(dat$hadults);    label(dat$adults     )  <- \"Number of adults at home\"\ndat$siblings      <- as.numeric(dat$hsiblings);  label(dat$siblings    ) <- \"Number of siblings at home\"\ndat$n_cars        <- as.numeric(dat$HMcars);     label(dat$n_cars     )  <- \"Number of cars at home\"\ndat$parents_walk  <- as.numeric(dat$WSpwalk);    label(dat$parents_walk) <- \"My parents walk regularly\"\ndat$parents_safe  <- as.numeric(dat$WSpunsafe);  label(dat$parents_safe) <- \"My parents think its not safe\"\n\n# Encouragement and role-modelling\ndat$parents_say   <- as.numeric(dat$WSpsh);      label(dat$parents_say)  <- \"My parents enourage me to walk\"\ndat$friends_say   <- as.numeric(dat$WSfsh);      label(dat$friends_say)  <- \"My friends enourage me to walk\"\ndat$school_says   <- as.numeric(dat$WSeschool);  label(dat$school_says)  <- \"My school enourages me to walk\"\ndat$cool          <- as.numeric(dat$WSbcool);    label(dat$cool    )     <- \"It's not cool to walk\"\ndat$friends_dont  <- as.numeric(dat$WSbfri);     label(dat$friends_dont) <- \"My friends don't walk\"\n\n# Physical environment\ndat$weather       <- as.numeric(dat$WSbweather); label(dat$weather )     <- \"The weather is too bad\"\ndat$boring_r      <- as.numeric(dat$WCSrbor);    label(dat$boring_r)     <- \"The route to school is boring\"\ndat$hills         <- as.numeric(dat$WCShills);   label(dat$hills   )     <- \"There are too many hills on the route\"\n\n# Lifestyle\ndat$regwalk          <- as.numeric(dat$TgWalk) ; label(dat$regwalk)      <- \"Walking for general mobility\"\n\n# Other\nlabel(dat$schiclose) <- \"I initially enrolled at the closest school\"\n#dat$closest          <- as.numeric(dat$schs5close); label(dat$closest)   <- \"My school is the closest to my home\"\n\n# create ordered factors and drop unused levels in the process\ndat$school_decile   <- ordered(   dat$ScDecile)\ndat$school_decile_n <- as.numeric(dat$school_decile)\n\n# Make more print-friendly levels\nlevels(dat$PAGuideQ)  <-c(\"No\", \"Yes\")\nlevels(dat$ScrGuide)  <-c(\"No\", \"Yes\")\n\n# Demographics and other variables not used for models\nlabel(dat$Age_at_Survey)   <- \"Age in years\"\nlabel(dat$gender)          <- \"Sex\"\nlabel(dat$BMI_2cat)        <- \"BMI\"\nlabel(dat$HMbike)          <- \"Number of bikes at home\"\nlabel(dat$HMcars)          <- \"Number of cars at home\"\nlabel(dat$tsdecision)      <- \"Who decides how you travel to school?\"\nlabel(dat$NZDepCat3)       <- \"NZ Deprivation Category\"\nlabel(dat$PAGuideQ)        <- \"Meets physical activity guidelines\"\nlabel(dat$ScrGuide)        <- \"Meets screen time guidelines\"\nlabel(dat$hsiblings )      <- \"Number of siblings at home\"\nlabel(dat$whodecides)      <- \"Who decides how you travel\"\nlabel(dat$school_decile_n) <- \"School decile\"\nlabel(dat$NEStConnect)     <- \"Connectivity\"\nlabel(dat$NGEsthetics)     <- \"Aesthetics\"\nlabel(dat$Dist2School)     <- \"Distance to school from home\"\nlabel(dat$BMI_f)           <- \"BMI\"\nlabel(dat$BMI_4cat)        <- \"Body Mass Index\"\nlabel(dat$eth3)            <- \"Ethnic category\"\nlabel(dat$TscWalk)             <- \"Travel to School: Walk\"\nlabel(dat$TscCarOth)           <- \"Travel to School: Car (others)\"\nlabel(dat$TscCarMy)            <- \"Travel to School: Car (mine)\"\nlabel(dat$TscBusPub)           <- \"Travel to School: Bus (public)\"\nlabel(dat$TscBusSc)            <- \"Travel to School: Bus (school\"\nlabel(dat$TSlike)              <- \"Do you like the way you usually travel to school?\"\nlabel(dat$ATS)                 <- \"ATS (3 categories)\"\nlabel(dat$BMI_4cat)            <- \"BMI (4 categories)\"\nlabel(dat$cars3)               <- \"Cars at home (3 categories)\"\ndat$ID <- as.numeric(as.character(dat$studyID1))\ndat$school <- factor(dat$school,\n                     labels=c(\"Bayfield\", \"Columba\", \"John McGlashan\",\n                              \"Kaikorai\", \"Kavanagh\", \"Kings\", \"Logan Park\",\n                              \"Otago Boys\", \"Otago Girls\", \"Queens\",\n                              \"St. Hilda's\", \"Taeri\"))\nlabel(dat$school) <- \"School\"\n\nats.vars <- c(\"ID\", \"school\", \"ATS_f\", \"gender\",\n              \"HMcars\", \"NZDepCat3\", \"PAGuideQ\",\n              \"ScrGuide\", \"whodecides\",\n              \"schiclose\",\n              \"Dist2School\",\n              \"siblings\", \"Age_at_Survey\", \"school_decile_n\",\n              \"interesting\", \"pleasant\", \"boring\",\n              \"healthy\", \"useful\", \"safe\", \"exercise\", \"onway\", \"time\",\n              \"stuff\", \"sched\", \"planning\", \"sweaty\", \"unsafe\", \"tired\",\n              \"desire\", \"confd\", \"control\", \"intention\", \"adults\", \"n_cars\",\n              \"parents_walk\", \"parents_safe\",\"parents_say\", \"friends_say\",\n              \"school_says\", \"cool\", \"friends_dont\", \"weather\", \"boring_r\",\n              \"hills\", \"regwalk\",\n              \"NEStConnect\", \"NGEsthetics\",\n              \"eth3\",\n              \"TscWalk\", \"TscCarOth\", \"TscCarMy\", \"TscBusPub\", \"TscBusSc\",\n              \"TSlike\", \"ATS\", \"BMI_4cat\", \"cars3\", \"tsdecision\")\n\n# Subset the data object to contain only the variables of interest\n#dat.ats <- dat[ dat$boarder2 == \"Not a boarder\", ats.vars]\ncutoff <- 8000\n\n# Remove implausible cases\nouts <- dat$Dist2School > cutoff & dat$ATS_f ==\"Walk\"\ndat  <- dat[!outs, ]\n\ndat.ats <- dat[ , ats.vars]\n#dat.ats <- dat[ dat$boarder == 1, ]\ndat.full <- dat[complete.cases(dat$Dist2School, dat$ATS_f),\n                c(\"Dist2School\", \"ATS_f\") ]\n\nnames( dat.ats )[ 2] <- \"School\"\nnames( dat.ats) [ 3] <- \"W2S\"\nnames( dat.ats )[ 4] <- \"Sex\"\nnames( dat.ats )[12] <- \"Dist\"\nnames( dat.ats )[15] <- \"Age\"\nlabel(dat.ats[,1]) <- \"Respondent ID\"\n\n#rm(dat.ats, dat.full, dat, cutoff, outs, ats.vars)\n\ndat.ats <- dat.ats[ dat.ats$Dist2School <= cutoff, ]\ndat.ats <- dat.ats[ complete.cases(dat.ats$W2S, dat.ats$Dist, dat.ats$School\n    #, dat.ats$parents_safe, dat.ats$parents_say, dat.ats$NEStConnect\n    #, dat.ats$NGEsthetics\n    ), ]\n\n",
    "created" : 1438124346948.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4173252287",
    "id" : "FF3C88EF",
    "lastKnownWriteTime" : 1455071000,
    "last_content_update" : 1455071000664,
    "path" : "~/Dropbox/Research/Collaboration/BEATS/John/Analysis/Correlates of ATS/data-setup-W2S.R",
    "project_path" : "data-setup-W2S.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}